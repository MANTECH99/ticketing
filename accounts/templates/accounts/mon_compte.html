{% extends 'base.html' %}
{% load static %}
<!-- templates/dashboard.html -->


{% block title %}Dashboard{% endblock %}

{% block content %}
<h2>Mon compte</h2>

<p>Bienvenue, {{ request.user.first_name }} {{ request.user.last_name }}</p>

<h3>Mes rÃ©servations :</h3>

{% if reservations %}
    <ul>
        {% for res in reservations %}
            <li>
                <strong>{{ res.event.title }}</strong><br>
                Date : {{ res.event.date|date:"d/m/Y H:i" }}<br>
                QuantitÃ© : {{ res.quantity }}<br>
                Statut : {{ res.status }}<br>
                Paiement : {{ res.payment_status }}<br>
                RÃ©servÃ© le : {{ res.created_at|date:"d/m/Y H:i" }}<br>

                {% if res.payment_status == "payÃ©" %}
                    <p>ğŸŸï¸ Tickets :</p>
                    <ul>
                        {% for ticket in res.ticket_set.all %}
                            <li>
                                <a href="{% url 'telecharger_ticket' ticket.id %}" target="_blank">
                                    TÃ©lÃ©charger ticket nÂ°{{ ticket.id }}
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p style="color: grey;">âš ï¸ Paiement non effectuÃ© â€“ tÃ©lÃ©chargement indisponible.</p>
                {% endif %}
            </li>
            <hr>
        {% endfor %}
    </ul>
{% else %}
    <p>Vous n'avez encore effectuÃ© aucune rÃ©servation.</p>
{% endif %}
{% endblock %}